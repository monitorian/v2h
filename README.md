# V2H for ECHONET Lite

V2H for ECHONET Liteは、ryo-aさんの[[ノーリツ製の給湯器リモコンをPCからNode.jsで操作する]](https://zenn.dev/ryo_a/articles/c9f515309d6f0b)を参考に、ECONET Liteプロトコルを用いてV2Hのステータスを確認するコマンドラインツールを試しに実装しています。
V2Hは、[ニチコン製VCG-666CN7（プレミアムモデル）](https://www.nichicon.co.jp/products/v2h/about/specs/)で動作を確認しています。

## 注意事項

本ツールはあくまでもPoC目的のため、商用目的および本ツールを常用することは想定していません。そのため、このツールを使う場合はすべて自己責任で行ってください。このソフトウェアに起因した損害が発生しても一切責任を負わないものとします。

## インストール

```
$ npm install -g v2h
```

## V2H機器側の設定
V2Hのスマホアプリ”EVPScontoller”を使い、[本体設定]->[HEMS連携設定]より”無効”以外の設定に変更し、ECONET Liteのプロトコルを受け付けられるようにしてください。
またペアリングしている無線LANのアクセスポイントを確認し、接続しているV2H機器のIPアドレスを確認してください。

### ステータス確認

現在のステータスを確認できます。

```
$ v2h status
⚡ v2h ⚡
項目名                       値                   
---------------------------- ---------------------
システム電源                 ON                   
ステータス                   平常                 
充電器タイプ                 DC_タイプAA（充放電）
定格充電能力(W)                               5900
定格放電能力(W)                               5900
車両接続・充放電可否状態     ff                   
車載電池の充電可能容量値(Wh)                 36900
車載電池の充電可能残容量(Wh)                 22100
運転モード設定               放電                 
車載電池の放電可能残容量(Wh)                  6500
車載電池の放電可能残容量(％)                    17
車両ID                       ff                   
車載電池の残容量(Wh)                         14800
車載電池の残容量(％)                            40
規格Version情報              00004a00     
```

## 参考
電気自動車充放電器・HEMSコントローラ間　アプリケーション通信インタフェース仕様 Ver.1.2*用　認証仕様書　電気自動車充放電器用　第1版
https://echonet.jp/wp/wp-content/uploads/obj_prop/LZ/LZ-000119/%5BEVPS-EVPS-A3-2%5D_Property.pdf